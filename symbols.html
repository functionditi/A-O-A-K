<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1.0"/>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/addons/p5.sound.min.js"></script>

  <title>Symbols Scrollbar</title>
  

  <style>
            /* ────────── RESET & FONTS ────────── */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        html, body {
            height: 100%;
            overflow: hidden;
        }
        @font-face {
            font-family: 'Trench';
            src: url('itf-trenches/Trench-Rounded-Complete/TrenchRounded-Light.otf') format('opentype');
        }
        @font-face {
            font-family: 'PP Mori';
            src: url('itf-trenches/PPMori-SemiBold.otf') format('opentype');
        }

        .text-box {
            font-size: 20px;
            color: #fff;
            line-height: 1.3;
            padding: 40px;
          }

          h2{
              font-family: 'Trench';
          }

          h3{
              font-family: 'PP Mori';
              font-size: 1.5rem;
          }

          p{
              font-family: 'PP Mori';
          }

        /* ────────── CONTAINER LAYOUT ────────── */
        .container {
            display: flex;
            height: 100vh;
            transition: all 0.5s ease;
            position: relative; /* needed for absolute scrollbar in full-mode */
        }

        /* ────────── SCROLLABLE CONTENT (LEFT) ────────── */
        .scrollable-content {
            background: #e26126;
            overflow-y: scroll;
            scrollbar-width: none;
            -ms-overflow-style: none;
            order: 0;
            width: calc((100% - 60px) * 2 / 3);
            max-width: calc((100% - 60px) * 2 / 3);
            flex: 0 0 auto;
            transition: width 0.5s ease, max-width 0.5s ease;
           
        }
        .scrollable-content::-webkit-scrollbar {
            display: none;
        }
        .top-bar {
            position: sticky;
            top: 0;
            background: #e26126;
            z-index: 999;
            display: flex;
            align-items: center;
            gap: 20px;
            padding: 20px;
        }
        .back-button {
            font-family: 'Trench';
            background: white;
            color: #e26126;
            border: none;
            border-radius: 25px;
            padding: 8px 16px;
            font-size: 18px;
            cursor: pointer;
        }
        .section-title {
            font-family: 'Trench';
            font-size: 24px;
            color: #e6d063;
        }

        /* ────────── CUSTOM SCROLLBAR (MIDDLE) ────────── */
        .custom-scrollbar {
            flex: 0 0 60px;
            order: 1;
            background-color: #fff;
            background-image: radial-gradient( #e6d063 1.5px, transparent 1px);
            /* border: 2px solid #e26126; */
            /* border: 0px 0px 2px 2px solid #e26126; */
            border: none;
            border-color: #e26126;
            border-right-style: solid;
            border-left-style: solid;
            border-width: 2px;
            background-size: 6px 6px;
          
            display: flex;
            justify-content: center;
            align-items: flex-start;
            z-index: 1000;
            transition: all 0.5s ease;
        }
        .track {
            width: 100%;
            height: 100%;
            position: relative;
        }
        .thumb {
            position: absolute;
            left: 0;
            right: 0;
            margin: auto;
            width: 100%;
            height: 50%;
            background: #e6d063;
            writing-mode: vertical-rl;
            text-orientation: mixed;
            font-family: 'PP Mori';
            color: #d35400;
            font-size: 20px;
            font-weight: bold;
            border-top: 2px solid #e26126;
            border-bottom: 2px solid #e26126;
            border-radius: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: top 0.1s ease;
        }

        /* ────────── FIXED RIGHT PANEL ────────── */
        .fixed-right {
            background: white;
            padding: 40px;
            display: flex;
            align-items: flex-end;
            justify-content: flex-start;
            width: 33.333%;
            transition: opacity 0.5s ease, width 0.5s ease;
            opacity: 1;
        }
        .statement-box {
            font-family: 'PP Mori';
            font-size: 24px;
            color: #e26126;
            line-height: 1.5;
        }

        /* ────────── FULL-MODE STATE (SECTION C) ────────── */
        .container.full-mode .scrollable-content {
            width: calc(100% - 60px);
            max-width: calc(100% - 60px);
        }
        .container.full-mode .fixed-right {
            width: 0;
            opacity: 0;
            pointer-events: none;
        }
        /* Make scrollbar overlay instead of push out */
        .container.full-mode .custom-scrollbar {
            position: absolute;
            right: 0;
            top: 0;
            height: 100%;
            width: 60px;
            order: unset;
            z-index: 1001;
        }

        /* ────────── ANIMATIONS ────────── */
        @keyframes slide-out-up {
            from { transform: translateY(0); opacity: 1; }
            to { transform: translateY(-100%); opacity: 0; }
        }
        @keyframes slide-out-down {
            from { transform: translateY(0); opacity: 1; }
            to { transform: translateY(100%); opacity: 0; }
        }
        @keyframes rise-in {
            from { transform: translateY(100%); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        @keyframes fall-in {
            from { transform: translateY(-100%); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        .slide-out-up {
            animation: slide-out-up 0.5s ease forwards;
        }
        .slide-out-down {
            animation: slide-out-down 0.5s ease forwards;
        }
        .rise-in {
            animation: rise-in 0.5s ease forwards;
        }
        .fall-in {
            animation: fall-in 0.5s ease forwards;
        }

  </style>

</head>
<body>
  <div class="container">
    <!-- left scrolling -->
    <div class="scrollable-content" id="scrollable-content">
      <div class="top-bar">
        <a href="./index.html"> <button class="back-button">  ⇠BACK</button></a>
        <h2 class="section-title">SYMBOLS</h2>
      </div>
      <!-- Section A (0–100vh) -->
      <div style="height:100vh;">
        <div class="text-box">
              <p>
              "Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum."
            </p>
            <br>
            <p>
            Section 1.10.32 of "de Finibus Bonorum et Malorum", written by Cicero in 45 BC
            "Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam, eaque ipsa quae ab illo inventore veritatis et quasi architecto beatae vitae dicta sunt explicabo. Nemo enim ipsam voluptatem quia voluptas sit aspernatur aut odit aut fugit, sed quia consequuntur magni dolores eos qui ratione voluptatem sequi nesciunt. Neque porro quisquam est, qui dolorem ipsum quia dolor sit amet, consectetur, adipisci velit, sed quia non numquam eius modi tempora incidunt ut labore et dolore magnam aliquam quaerat voluptatem. Ut enim ad minima veniam, quis nostrum exercitationem ullam corporis suscipit laboriosam, nisi ut aliquid ex ea commodi consequatur? Quis autem vel eum iure reprehenderit qui in ea voluptate velit esse quam nihil molestiae consequatur, vel illum qui dolorem eum fugiat quo voluptas nulla pariatur?"

            </p>
            <br>
              <p>
              1914 translation by H. Rackham
              "But I must explain to you how all this mistaken idea of denouncing pleasure and praising pain was born and I will give you a complete account of the system, and expound the actual teachings of the great explorer of the truth, the master-builder of human happiness. No one rejects, dislikes, or avoids pleasure itself, because it is pleasure, but because those who do not know how to pursue pleasure rationally encounter consequences that are extremely painful. Nor again is there anyone who loves or pursues or desires to obtain pain of itself, because it is pain, but because occasionally circumstances occur in which toil and pain can procure him some great pleasure. To take a trivial example, which of us ever undertakes laborious physical exercise, except to obtain some advantage from it? But who has any right to find fault with a man who chooses to enjoy a pleasure that has no annoying consequences, or one who avoids a pain that produces no resultant pleasure?"

              </p>
      <br>
        </div>
      </div>
      <!-- Section B (100–200vh) -->
      <div style="height:200vh;">
        <div class="text-box">
          <p>
            Kolam Symbols: Drawing Down Desire through Ritual, Geometry, and Embodiment
            The symbols in a kolam—a traditional South Indian floor drawing—carry layers of meaning that extend far beyond their geometric forms. To understand why kolams look the way they do is to unravel a rich tapestry of cultural, spiritual, material, and embodied practices. At their core, kolams are not simply decorative patterns; they are visual manifestations of desires, intentions, and relational acts embedded into daily ritual. They are simultaneously inscriptions of personal and cosmic order.

            1. Drawing Down Desire: Kolam as Ritualized Intention
            Kolams are traditionally drawn at the threshold of a home, welcoming prosperity, protecting the household, and warding off evil. But their role is deeper than symbolic decoration—they are a way of drawing down desire, a ritualized inscription of wishes, prayers, and intentions onto the earth. In the interview, artist Aarati reflects on encrypting her grandmother’s name into a kolam after her passing, reframing the act of mourning as a personal ritual of honoring maternal lineage. This gesture transforms the kolam from a static motif into a performative, coded message of love and remembrance. Similarly, Vijaya speaks of rangoli as a spiritual offering—its beauty meant for the divine, not permanence. Each line, curve, and loop becomes an embodied prayer, a visualization of what the maker wishes to bring into the world.

            This dimension of desire makes kolams a form of visual coding, not unlike talismans or protective charms. Their symbols channel not only aesthetic preferences but also intentions—for prosperity, health, fertility, peace. Kolam is both a ritual of communication and a form of wish-making, embedding hopes into space and time.

            2. Embodiment, Matrilineality, and the Performed Act
            Kolams are passed down primarily through matrilineal lines, a knowledge carried in the body. As Dr. Vijaya Nagarajan notes, many women can draw kolams in the dark, guided by muscle memory, an “embodied interaction with the environment.” The body learns the kolam through repetition; the mind memorizes its loops and turns through practice. To draw a kolam is to engage the whole body in a choreography of gestures: bending down, pinching the flour, tracing a path, aligning symmetry by hand.

            This embodied aspect cannot be separated from its meaning. Drawing a kolam is an act of physical offering, a daily ritual that literally bends the body in humility and care. As Nagarajan reflects, the kolam was historically a quiet “language of tenderness” in the community—a way of signaling care, capacity, or even distress. If a kolam was absent from someone’s doorstep, neighbors knew the household might be in need and would bring food or support. Thus, the kolam functioned not only as a symbol of desire, but as a material expression of relational care, enacted through the body in space.

            3. Geometry, Natural Resonance, and Cymatics
            Visually, kolams are constructed around grids of dots (pulli), connected through loops, curves, and lines that weave around them. Their intricate symmetries and recursive forms evoke natural patterns—fractal branching, spiral growth, radial balance. This geometry is not arbitrary; it is aligned with universal principles of balance, harmony, and cyclical order. Artists like Aarati have drawn parallels between kolam patterns and cymatics—the geometric shapes formed by sound vibrations on a surface. Kolam, like a Chladni figure, captures invisible forces into visible form, resonating with natural laws of vibration, symmetry, and flow.

            The kolam’s symbols emerge from this interplay between intentional design and emergent form. Each pattern must obey certain constraints—symmetry, continuity, closure—yet within these rules lies infinite variation. This dance between structure and improvisation mirrors broader cultural values around adaptability, balance, and order.

            4. Materiality, Ephemerality, and Feeding the Earth
            Traditionally made with rice flour, kolams are inherently ephemeral. They are drawn in the morning and gradually erased by footsteps, wind, or rain. But this impermanence is not loss; it is integral to their meaning. As Vijaya explains, kolams feed ants and birds, offering a small act of charity back to the ecosystem. The ritual acknowledges that human homes occupy land once shared with other beings, enacting a gesture of reciprocity toward the more-than-human world.

            The floor as canvas shapes the kolam’s form—its scale, reach, and surface texture. But artists today also translate kolams into other materials: etched onto banana leaves (as Aarati did), made with colored powders, painted onto tables, or rendered digitally. Each medium carries different affordances and compromises, raising questions of authenticity, context, and meaning.

            5. Translation into Technology: Between Ritual and Representation
            As kolams move into gallery spaces, digital screens, or code-based systems, they encounter new challenges. Aarati speaks of coding her kolams left-to-right, top-to-bottom, diverging from their radial tradition. Dr. Nagarajan warns against flattening kolams into mere aesthetics; the act of drawing is as essential as the image produced. A kolam drawn by a plotter or projected onto a wall risks losing its embodied, performative, and relational dimensions.

            At the same time, technological translations can invite new engagements. Aarati’s interactive website requires users to “touch every tile” to reveal an encrypted message, transforming the digital interaction into a slow, reverent decoding. Here, technology is not just reproducing a pattern—it is reshaping how audiences encounter the kolam’s meaning.

            This tension raises important questions: Is a machine-drawn kolam a real kolam, or a representation of one? What happens to the ritual of drawing when the body is replaced by code? As Nagarajan suggests, the kolam holds potential as a critique of modern, extractive mindsets—its generosity, its temporality, its relational care offering an alternative worldview. To mechanize or aestheticize the kolam risks losing its capacity to “draw down desire” as an embodied, intentional, communal act.

            Conclusion: Kolam as an Embodied Desire, Not Just a Symbol
            The symbols in a kolam are shaped by an entanglement of ritual desire, embodied action, geometric logic, material engagement, and cultural transmission. They are not simply images but performed inscriptions, drawn from body, mind, and earth, reaching outward to the divine, the neighbor, the insect, the stranger.

            To understand why a kolam looks the way it does is to see it not as a frozen design but as a living choreography of desires—each line a thread binding care, memory, hospitality, and hope into the everyday ground beneath our feet.

            In translating kolam into technological forms, the challenge is not merely replicating patterns but preserving the ritual intentionality, the drawing down of desires, the embodied generosity that make the kolam not only an artwork but a profound ritual of relation.
          </p>
        </div>
      </div>
      <!-- Section C (200–300vh) -->
      <div style="height:100vh; background:#d35400;">
        
      </div>
      <!-- Section D (300–400vh) -->
      <div id="sketch-container"  style="height:100vh; background:#a83279;"></div>   
    </div>

    <!-- scrollbar -->
    <div class="custom-scrollbar">
      <div class="track">
        <div class="thumb" id="scroll-thumb"><span>symbols</span></div>
      </div>
    </div>

    <!-- fixed right -->
    <div class="fixed-right">
      <div class="statement-box" id="fixed-text">
        <p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit...</p>
      </div>
    </div>
  </div>

  <script>
    const container     = document.querySelector('.container');
    const scrollContent = document.getElementById('scrollable-content');
    const fixedPanel    = document.getElementById('fixed-text');
    const originalHTML  = fixedPanel.innerHTML;
    const thumb         = document.getElementById('scroll-thumb');

    let changed = false, lastY = 0, inC = false;
    const vh = window.innerHeight;

    scrollContent.addEventListener('scroll', () => {
      const y   = scrollContent.scrollTop;
      const dir = y > lastY ? 'down' : 'up';

      // swap at 1×vh
      if (!changed && y > vh) {
        doSwap('<p>hello text text i have changed</p>', dir);
        changed = true;
      } else if (changed && y <= vh) {
        doSwap(originalHTML, dir);
        changed = false;
      }

      // full-mode at 3×vh
      if (!inC && y > 3*vh) {
        container.classList.add('full-mode');
        inC = true;
      } else if (inC && y <= 2*vh) {
        container.classList.remove('full-mode');
        inC = false;
      }

      updateThumb();
      lastY = y;
    });

    function doSwap(html, dir) {
      // remove any existing p
      const oldP = fixedPanel.querySelector('p');
      if (oldP) oldP.remove();

      // insert the new one
      const newP = document.createElement('p');
      newP.innerHTML = html.replace(/^<p>|<\/p>$/g, '');
      fixedPanel.appendChild(newP);

      // animate
      if (dir === 'down') {
        newP.classList.add('rise-in');
      } else {
        newP.classList.add('fall-in');
      }
      // cleanup
      newP.addEventListener('animationend', () => {
        newP.classList.remove('rise-in','fall-in');
      }, { once: true });
    }

    function updateThumb() {
      const ch = scrollContent.clientHeight,
            sh = scrollContent.scrollHeight,
            st = scrollContent.scrollTop;
      const trackH = ch,
            thumbH = trackH/2,
            maxOff = trackH - thumbH,
            pct    = st/(sh-ch);
      thumb.style.top = `${pct*maxOff}px`;

      // round corners
      if (st===0) {
        thumb.style.borderTopLeftRadius='0';
        thumb.style.borderTopRightRadius='0';
      } else if (st+ch>=sh-1) {
        thumb.style.borderBottomLeftRadius='0';
        thumb.style.borderBottomRightRadius='0';
      } else {
        thumb.style.borderRadius='30px';
      }
    }

    window.addEventListener('load', () => {
      scrollContent.dispatchEvent(new Event('scroll'));
    });
    window.addEventListener('resize', updateThumb);
  
      let particles, m, n, a, b, v;
      let particleSize = 8; // Global particle size
      let minWalk = 0.002;
      let mic, fft;
      let volume;

      // Settings: number of particles (canvas size is now full screen)
      const settings = {
        nParticles: 10000,
        drawHeatmap: false,
      };

      const pi = 3.1415926535;

      // Chladni 2D closed-form solution (returns a value between -1 and 1)
      const chladni = (x, y, a, b, m, n) =>
        a * sin(pi * n * x) * sin(pi * m * y) +
        b * sin(pi * m * x) * sin(pi * n * y);

      const DOMinit = () => {
        // Create a full-screen canvas using windowWidth and windowHeight
        let canvas = createCanvas(windowWidth, windowHeight);
        canvas.parent("sketch-container");
      };

      const setupParticles = () => {
        particles = [];
        for (let i = 0; i < settings.nParticles; i++) {
          particles.push(new Particle());
        }
      };

      class Particle {
        constructor() {
          this.x = random(0, 1);
          this.y = random(0, 1);
          this.updateOffsets();
        }

        move() {
          // Calculate the Chladni value for this particle
          let eq = chladni(this.x, this.y, a, b, m, n);
          // Determine movement amplitude
          let amplitude = v * abs(eq);
          if (amplitude < minWalk) amplitude = minWalk;
          this.x += random(-amplitude, amplitude);
          this.y += random(-amplitude, amplitude);
          this.updateOffsets();
        }

        updateOffsets() {
          // Constrain within the unit square and convert to screen space
          this.x = constrain(this.x, 0, 1);
          this.y = constrain(this.y, 0, 1);
          this.xOff = width * this.x;
          this.yOff = height * this.y;
        }

        show() {
          noStroke();
          fill("#f25c05");
          ellipse(this.xOff, this.yOff, particleSize, particleSize);
        }
      }

      const moveParticles = () => {
        for (let particle of particles) {
          particle.move();
          particle.show();
        }
      };

      const drawHeatmap = () => {
        if (settings.drawHeatmap) {
          let res = 3;
          for (let i = 0; i <= width; i += res) {
            for (let j = 0; j <= height; j += res) {
              let eq = chladni(i / width, j / height, a, b, m, n);
              strokeWeight(1);
              stroke();
              fill("#f25c05");
              square(i, j, res);
            }
          }
        }
      };

      const wipeScreen = () => {
        background("#FFF");
        stroke("#f25c05");
      };

      // p5.js setup
      function setup() {
        DOMinit();
        setupParticles();

        // Initialize microphone and FFT analysis
        mic = new p5.AudioIn();
        mic.start();
        fft = new p5.FFT();
        fft.setInput(mic);

        // Set default vibration strength for particle movement
        v = 0.03;
      }

      // p5.js draw loop
      function draw() {
        // Get overall volume and amplify it
        volume = mic.getLevel() * 1000;
        console.log(volume)
        // Map overall volume to m (ensuring it's an integer between 1 and 16)
        m = int(map(volume, 0, 5, 1, 16));

        // Analyze the sound's frequency spectrum
        let spectrum = fft.analyze();

        // Extract frequency components:
        let bass = fft.getEnergy("bass");         // Low-frequency energy
        let treble = fft.getEnergy("treble");       // High-frequency energy
        let spectralCentroid = fft.getCentroid();   // "Brightness" of the sound

        // Map frequency-based values to the other Chladni parameters:
        n = int(map(bass, 0, 255, 1, 2));         // n controlled by bass energy
        a = map(treble, 0, 255, -2, 2);             // a controlled by treble energy
        b = map(spectralCentroid, 0, 8000, -2, 2);   // b controlled by spectral centroid

        wipeScreen();
        drawHeatmap();
        moveParticles();

        // Update parameter display text
        let paramsDiv = document.getElementById("parameters");
        if (paramsDiv) {
          paramsDiv.innerHTML = `
            m: ${m} <br>
            n: ${n} <br>
            a: ${a.toFixed(2)} <br>
            b: ${b.toFixed(2)}
          `;
        }
      }

      // Adjust canvas size when the window is resized
      function windowResized() {
        resizeCanvas(windowWidth, windowHeight);
      }

      // Optional: adjust particle count via key presses
      function keyPressed() {
        if (key === "+") {
          particles.push(new Particle());
        } else if (key === "-") {
          if (particles.length > 1) {
            particles.pop();
          }
        }
      }
    </script>
</body>
</html>
